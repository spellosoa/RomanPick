<!DOCTYPE HTML>
<!--
   Astral by HTML5 UP
   html5up.net | @ajlkn
   Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
   <title>RomanPick</title>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
   <link rel="stylesheet" href="{{ url_for('RomanPick', path='/assets/css/main.css') }}" />
	<noscript>
		<link rel="stylesheet" href="{{ url_for('RomanPick', path='assets/css/noscript.css') }}" />
	</noscript>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body class="is-preload">

   <!-- Wrapper-->
   <div id="wrapper">


      <!-- Nav -->
      <nav id="nav">
         <a href="/main#home" class="icon solid fa-home" style="color: #D96A80;"><span>RomanPick</span></a>
			<a href="#home" class="icon solid fa-heart" style="color: #D96A80;"><span>Heart</span></a>
         <a href="#barcode" class="icon solid fa-camera" style="color: #D96A80;"><span>Barcode</span></a>
         <a href="#emotion" class="icon solid fa-smile" style="color: #D96A80;"><span>Emotion</span></a>
      </nav>

      <!-- Main -->
      <div id="main">

         <!-- Me -->
         <article id="home" class="panel intro">
            <header class="title_h" style="display: none;">
               <h2 style="font-size: 35px; color:#D96A80; text-align: center; font-weight: bold;">
                  [ 유사한 웹소설 List ]
               </h2>
            </header>
            <header class="title_h" style="display: none;">
               <div style="text-align:center; position:relative;">
                  <section>
                     <div class="container">
                        <div class="list_title-row">
                           <div class="col-md-4" style="padding: 30px">
                              <div class="list_title-container">
                                 <a href="#" class="image fit">
                                    <img id="title_img" src="" alt=""
                                    style="display: block; margin: 0 auto;">
                                 </a>
                              </div>
                           </div>
                           <div class="col-md-6">
                              <div class="title-container">
                                 <a class="title"></a>
                                 <hr>
                                 <a class="content">
                                 </a><br>
                                 <a href="#" id="show-more" style="font-size: 0.9rem; color: black; text-decoration-line: none; display: none;">&nbsp; &nbsp; &nbsp; &nbsp;< 더 보기 ></a>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  

                  <hr id="title_hr">
                  <br>
                  
                  <div class="list-grid">
                     <div id="loading-overlay_barcode">
                        <div id="loading-spinner"></div>
                      </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel1" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>
                     
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel2" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>
                     
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel3" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>
                     
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel4" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>

                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel5" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>

                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novel6" class="image fit">
                           <img src="" alt="">
                        </a>
                        <a href="#" id="title-a"></a>
                     </div>
                     
               </div>
               
            </header>
            <header class="keyword_h" style="display: none;">
               <h2 class="title_key" style="font-size: 35px; color:#D96A80; text-align: center; font-weight: bold;">[ KeyWord ]</h2>
               <p id="keywod_title" style="text-align: center; font-weight: bold;"></p> 
                 
               <hr id="keyword_hr">
                 
               <div style="text-align:center; position:relative;">
                  <div class="list-grid">
                  
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell1" class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic12.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell2" class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic11.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell3"class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic10.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell4" class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic09.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell5" class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic08.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                     <div class="col-4 col-6-medium col-12-small" data-modal="#modal2">
                        <a href="#" id="novell6" class="image fit">
                           <img src="{{ url_for('RomanPick', path='images/pic07.jpg') }}" alt="">
                        </a>
                        <a href="" id="title-a">제목</a>
                     </div>
                  </div>
               </div>
               
            </header>

            <div id="modal2" class="modal modal--align-top modal__bg" role="dialog" aria-hidden="true">
               <div class="modal__dialog">
                   <div class="modal__content">
                       <h3 style="font-weight:bold; font-size: 30px;">제목</h3>
                       <hr>
                       <p><img src="http://unsplash.it/600/300" alt="" /></p>
                       <h6 style="font-size:15px; text-align:justify">
                           줄거리줄거리줄거리줄거리줄거리줄거리줄거리줄거리
                           줄거리줄거리줄거리줄거리줄거리줄거리줄거리줄거리
                           줄거리줄거리줄거리줄거리줄거리줄거리줄거리줄거리
                       </h6>
                       
                       
                       <!-- modal close button -->
                       <a href="" class="modal__close demo-close">
                           <svg class="" viewBox="0 0 24 24">
                               <path
                                   d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z" />
                               <path d="M0 0h24v24h-24z" fill="none" />
                           </svg>
                       </a>
                   </div>
               </div>
           </div>

            <article id="contact" class="panel" style="text-align: center; margin-bottom: 20px;">
               <form style="background:none;">
                  <div id="backBtn" style="float: right; width: auto; padding:auto; text-align: center;">
                     <a class="btn" href="#" style="text-align: center;">
                        <i class="fas fa-backspace" style="color: #D96A80; font-size: xx-large;"></i>
                     </a>
                  </div>
               </form>
            </article>

         </article>

         

         <!-- Work -->
         <article id="barcode" class="panel"></article>

         <!-- Contact -->
         <article id="emotion" class="panel"></article>

         <!-- Me -->
         <article id="game" class="panel intro">
            <header>
               <div style="text-align: center;">
                  <h1>연애시뮬레이션 공간</h1>
                  <p>Senior Astral Projectionist</p>
               </div>
            </header>
            <header>
               <div style="text-align: center;">
                  <h1>퍼즐 공간</h1>
                  <p>Senior Astral Projectionist</p>
               </div>
            </header>
         </article>

      </div>

      

   </div>

   <!-- Scripts -->
   <script>
      $(document).ready(function(){
         $.ajax({
            url: '/RomanPick/02-2_emotion.html',
            type: 'GET',
            dataType: 'html',
            success: function(response) {
               $('#emotion').html(response);
            }
         });
         $.ajax({
            url: '/RomanPick/02-1_barcode.html',
            type: 'GET',
            dataType: 'html',
            success: function(response) {
               $('#barcode').html(response);
            }
         });

         var go = "{{go}}";
         if(go == "title"){
            $('.title_h').css('display', 'block');
            $('#title_img').attr('src', "{{ url_for('RomanPick', path=data['novel_cover']) }}");
            $('.title-container').children('.title').text(`< {{data['novel_nm']}} >`);
            $('.title-container').children('.content').text(`{{data['novel_synopsis']}}`);
            more();
            // 선택된 소설과 유사한 소설 6개 추출 ajax
            $.ajax({
               url:"/cosine/{{data['novel_no']}}",
               type:'get',
               success:function(cosine_novel_no){
                  // 가져온 6개 소설번호를 이용해 소설 정보 추출
                     $.ajax({
                        url:`/select/novel_no_6`,
                        type:"post",
                        contentType: "application/json",
                        data:JSON.stringify(cosine_novel_no),
                        success:function(data){
                           for(var i=0; i<6; i++){
                              var novel = $(`#novel${i+1}`)
                              novel.children('img').attr('src', `{{ url_for('RomanPick', path='${data[i].novel_cover}') }}`);
                              novel.next().text(data[i].novel_nm);
                           }
                           
                           Modal.init();
            
                        }
                  })
                  
               }
            });
            
         }else if(go == "barcode"){
            
            $('#title_img').attr('src', "{{data['novel_cover']}}")
            $('.title_h').css('display','block');
            $('.title-container').children('.title').text(`< {{data['novel_nm']}} >`);
            $('.title-container').children('.content').text(`{{data['novel_synopsis']}}`);
            more();
            var isbn_synopsis = `{{data['novel_synopsis']}}`;
            var data = {"synposis" : isbn_synopsis};
            
            $.ajax({
               url:'/expert_noun',
               type:'post',
               contentType: "application/json",
               data:JSON.stringify(data),
               beforeSend:function(){
                  $('#loading-overlay_barcode').css('display', 'flex');
              },
               success:function(data){
                  $('#loading-overlay_barcode').css('display', 'none');
                  for(var i=0; i<6; i++){
                     var novel = $(`#novel${i+1}`)
                  novel.children('img').attr('src', `{{ url_for('RomanPick', path='${data[i].novel_cover}') }}`);
                  novel.next().text(data[i].novel_nm);
                  }
                  Modal.init()
               }

            })

            $('#backBtn').click(function(e){
               e.preventDefault();
               window.location.href="/main#barcode";
            })

            // ajax로 데이터 전송
         }else if(go=='keyword'){
            $('.title_h').css('display', 'none');
            $('.keyword_h').css('display', 'block');
            $('#keywod_title').text(`{{data['word']}}`);

            $.ajax({
               url:'/label/keyword',
               type:'get',
               data:{
                  "label": '{{label}}',
                  "keyword": `{{data['word']}}`
               },
               success:function(data){
                  for(var i=0; i<6; i++){
                     var novel = $(`#novell${i+1}`)
                     novel.children('img').attr('src', `{{ url_for('RomanPick', path='${data[i].novel_cover}') }}`);
                     novel.next().text(data[i].novel_nm);
                  }
                  Modal.init();
               }
            })
         }else if(go == "emotion"){
            $('.title_h').css('display', 'none');
            $('.keyword_h').css('display', 'block');
            $('.title_key').text('[ emotion ]');
            var emotion = `{{emotion}}`;
            var ko_emo = "";
            if(emotion == 'HAPPY'){
               ko_emo = "기쁨";
            }else if(emotion == 'EMB'){
               ko_emo = "당황";
            }else if(emotion == 'HURT'){
               ko_emo = "상처";
            }else if(emotion == 'UNREST'){
               ko_emo = "불안";
            }else if(emotion == 'SAD'){
               ko_emo = "슬픔";
            }else if(emotion == 'ANGRY'){
               ko_emo = "분노";
            }
            $('#keywod_title').text(ko_emo);
            var data = {"emotion":"{{emotion}}"};
            $.ajax({
               url:'/emotion/novel',
               type:'post',
               contentType: "application/json",
               data:JSON.stringify(data),
               success:function(data){
                  for(var i=0; i<6; i++){
                     var novel = $(`#novell${i+1}`)
                     novel.children('img').attr('src', `{{ url_for('RomanPick', path='${data[i].novel_cover}') }}`);
                     novel.next().text(data[i].novel_nm);
                  }
                  Modal.init();
               }
            })
         }
      })
   </script>
   <script>
      $('#backBtn').click(function(e){
         e.preventDefault();
         window.history.go(-1);
         })
       // 줄거리 더보기
       $('.image.fit').click(function(e){
         e.preventDefault();
       })
      function more() {
         var content = $('.content');
         var showMoreBtn = $('#show-more');
         var fullText = content.text();
         var maxCharacters = 100; // 최대 글자 수
      
         if (content.text().length > maxCharacters) {
            var trimmedText = fullText.slice(0, maxCharacters) + '...';
            content.text(trimmedText);
            showMoreBtn.show();
         }
         
         // 더보기 토글
         showMoreBtn.click(function(e) {
            e.preventDefault();
            if (showMoreBtn.text().trim() === '< 더 보기 >') {
               content.text(fullText);
               showMoreBtn.html('&nbsp;&nbsp;&nbsp;&nbsp;< 접기 >')
            }else{
               content.text(trimmedText);
               showMoreBtn.html('&nbsp;&nbsp;&nbsp;&nbsp;< 더 보기 >')
            }
         });
      }
      var Modal = (function() {
         var trigger = $qsa('.col-4.col-6-medium.col-12-small'); // what you click to activate the modal
         var modals = $qs('.modal'); // the entire modal (takes up entire window)
         var modalsbg = $qs('.modal__bg'); // the entire modal (takes up entire window)
         var content = $qs('.modal__content'); // the inner content of the modal
         var closers = $qs('.modal__close'); // an element used to close the modal
         var w = window;
         var isOpen = false;
         var contentDelay = 400; // duration after you click the button and wait for the content to show
         var len = trigger.length;
      
         // make it easier for yourself by not having to type as much to select an element
         function $qsa(el) {
         return document.querySelectorAll(el);
         }
         function $qs(el){
            return document.querySelector(el);
         }
      
         var getId = function(event) {
      
            event.preventDefault();
            var self = this;
            var img_url = $(this).children('.image.fit').children('img').attr('src');
            var title = $(this).children('#title-a').text();
            $('#modal2 img').attr('src', `${img_url}`);
            data = {"img":img_url.split('RomanPick/')[1]};
            $.ajax({
               url:'/novel_cover_select',
               type:'post',
               contentType: "application/json",
               data:JSON.stringify(data),
               success:function(synopsis){
                  var synopsis = synopsis;
                  $('.modal__content').children('h6').text(synopsis);
               }
            })
         
        $('.modal__content').children('h3').text('<' + title + '>');
        

         // get the value of the data-modal attribute from the button
         var modalId = self.dataset.modal;
         var len = modalId.length;
         // remove the '#' from the string
         var modalIdTrimmed = modalId.substring(1, len);
         // select the modal we want to activate
         var modal = document.getElementById(modalIdTrimmed);
         // execute function that creates the temporary expanding div
         makeDiv(self, modal);
         };
      
         var makeDiv = function(self, modal) {
      
         var fakediv = document.getElementById('modal__temp');
      
         /**
            * if there isn't a 'fakediv', create one and append it to the button that was
            * clicked. after that execute the function 'moveTrig' which handles the animations.
            */
      
         if (fakediv === null) {
            var div = document.createElement('div');
            div.id = 'modal__temp';
            self.appendChild(div);
            moveTrig(self, modal, div);
         }
         };
      
         var moveTrig = function(trig, modal, div) {
         var trigProps = trig.getBoundingClientRect();
         var m = modal;
         var mProps = m.querySelector('.modal__content').getBoundingClientRect();
         var transX, transY, scaleX, scaleY;
         var xc = w.innerWidth / 2;
         var yc = w.innerHeight / 2;
      
         // this class increases z-index value so the button goes overtop the other buttons
         //trig.classList.add('modal__trigger--active');
      
         // these values are used for scale the temporary div to the same size as the modal
         scaleX = mProps.width / trigProps.width;
         scaleY = mProps.height / trigProps.height;
      
         scaleX = scaleX.toFixed(3); // round to 3 decimal places
         scaleY = scaleY.toFixed(3);
      
      
         // these values are used to move the button to the center of the window
         transX = Math.round(xc - trigProps.left - trigProps.width / 2);
         transY = Math.round(yc - trigProps.top - trigProps.height / 2);
      
            // if the modal is aligned to the top then move the button to the center-y of the modal instead of the window
         if (m.classList.contains('modal--align-top')) {
            transY = Math.round(mProps.height / 2 + mProps.top - trigProps.top - trigProps.height / 2);
         }
      
      
            // translate button to center of screen
            trig.style.transform = 'translate(' + transX + 'px, ' + transY + 'px)';
            trig.style.webkitTransform = 'translate(' + transX + 'px, ' + transY + 'px)';
            // expand temporary div to the same size as the modal
            div.style.transform = 'scale(' + scaleX + ',' + scaleY + ')';
            div.style.webkitTransform = 'scale(' + scaleX + ',' + scaleY + ')';
      
      
            window.setTimeout(function() {
               window.requestAnimationFrame(function() {
                  open(m, div);
               });
            }, contentDelay);
      
         };
      
         var open = function(m, div) {
      
         if (!isOpen) {
            // select the content inside the modal
            var content = m.querySelector('.modal__content');
            // reveal the modal
            m.classList.add('modal--active');
            // reveal the modal content
            content.classList.add('modal__content--active');
      
            /**
            * when the modal content is finished transitioning, fadeout the temporary
            * expanding div so when the window resizes it isn't visible ( it doesn't
            * move with the window).
            */
      
            content.addEventListener('transitionend', hideDiv, false);
      
            isOpen = true;
         }
      
         function hideDiv() {
            // fadeout div so that it can't be seen when the window is resized
            div.style.opacity = '0';
            content.removeEventListener('transitionend', hideDiv, false);
         }
         };
      
         var close = function(event) {
      
            event.preventDefault();
         event.stopImmediatePropagation();
      
         var target = event.target;
         var div = document.getElementById('modal__temp');
      
         /**
            * make sure the modal__bg or modal__close was clicked, we don't want to be able to click
            * inside the modal and have it close.
            */
      
         if (isOpen && target.classList.contains('modal__bg') || target.classList.contains('modal__close')) {
      
            // make the hidden div visible again and remove the transforms so it scales back to its original size
            div.style.opacity = '1';
            div.removeAttribute('style');
      
               /**
               * iterate through the modals and modal contents and triggers to remove their active classes.
            * remove the inline css from the trigger to move it back into its original position.
               */
      
               for (var i = 0; i < len; i++) {
                  modals.classList.remove('modal--active');
                  content.classList.remove('modal__content--active');
                  trigger[i].style.transform = 'none';
                  trigger[i].style.webkitTransform = 'none';
                  trigger[i].classList.remove('modal__trigger--active');
               }
      
            // when the temporary div is opacity:1 again, we want to remove it from the dom
               div.addEventListener('transitionend', removeDiv, false);
            isOpen = false;
      
         }
      
         function removeDiv() {
            setTimeout(function() {
               window.requestAnimationFrame(function() {
               // remove the temp div from the dom with a slight delay so the animation looks good
               div.remove();
               });
            }, contentDelay - 50);
         }
      
         };
      
         var bindActions = function() {
         for (var i = 0; i < len; i++) {
            trigger[i].addEventListener('click', getId, false);
            closers.addEventListener('click', close, false);
            modalsbg.addEventListener('click', close, false);
         }
         };
      
         var init = function() {
         bindActions();
         };
      
         return {
         init: init
         };
      
      }());
   </script>
   

   <script src="{{ url_for('RomanPick', path='assets/js/browser.min.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/breakpoints.min.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/util.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/main.js') }}"></script>
   <script src="{{ url_for('RomanPick', path='assets/js/barcode.js') }}"></script>
   <script src="{{ url_for('RomanPick', path='assets/js/emotion.js') }}"></script>
</body>

</html>